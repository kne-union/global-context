{"version":3,"file":"static/js/830.4854f8d7.chunk.js","mappings":"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","sources":["../../src/createContext.js","../../src/globalContext.js","../../src/Global.js"],"sourcesContent":["import {\n  createContext as createReactContext, useContext as useReactContext\n} from \"react\";\n\nconst createContext = (initValue = {}) => {\n  const context = createReactContext(initValue);\n  const { Provider, Consumer } = context;\n  const useContext = () => useReactContext(context);\n\n  return { context, Provider, Consumer, useContext };\n};\n\nexport default createContext;\n","import createContext from \"./createContext\";\n\nexport const context = createContext({});\n\nexport const { Provider, Consumer, useContext } = context;\n\nexport const useGlobalContext = useContext;\n\nexport const usePreset = () => {\n  const contextValue = useContext();\n  return Object.assign({}, { apis: {} }, contextValue?.preset);\n};\n\nexport default context;\n","import React, { useState, useCallback, useEffect, useRef } from \"react\";\nimport { Provider, useContext, usePreset } from \"./globalContext\";\nimport createProps, { createFunction } from \"@kne/create-props\";\n\nconst globalPropTypes = createProps(\"Global\", (z) => {\n  return {\n    preset: z.unknown().default({}).describe(\"global中的预设参数，组件初始化时传入不可修改\"), children: z.unknown()\n  };\n}, \"context的Provider\");\n\nconst Global = (p) => {\n  const { preset, children, ...props } = globalPropTypes(p);\n  const [global, setGlobal] = useState({});\n\n  const setGlobalWithKey = useCallback((globalKey, value) => {\n    setGlobal((global) => {\n      return Object.assign({}, global, { [globalKey]: typeof value === \"function\" ? value(global[globalKey]) : value });\n    });\n  }, []);\n\n  return <Provider value={{ ...props, global, preset, setGlobal, setGlobalWithKey }}>\n    {children}\n  </Provider>;\n};\n\nconst globalSettingPropTypes = createProps(\"GlobalSetting\", (z) => {\n  return {\n    loader: z.function().describe(\"设置到global的值，为一个或多个键值对，将会和之前的global进行Object.assign合并\").returns(z.promise(z.unknown())),\n    needReady: z.boolean().default(true).describe(\"是否在global值设置好之前不显示children\"),\n    children: z.unknown()\n  };\n}, \"设置global的值，通常是通过异步获取\");\n\nexport const GlobalSetting = (p) => {\n  const { loader, needReady, children } = globalSettingPropTypes(p);\n  const [loaded, setLoaded] = useState(false);\n  const { global, setGlobal } = useContext();\n  const globalRef = useRef(null);\n  const loaderRef = useRef(loader);\n  useEffect(() => {\n    loaderRef.current().then((target) => {\n      setGlobal((global) => {\n        const nextGlobal = Object.assign({}, global, target);\n        globalRef.current = nextGlobal;\n        return nextGlobal;\n      });\n    });\n  }, []);\n\n  useEffect(() => {\n    if (global === globalRef.current) {\n      setLoaded(true);\n    }\n  }, [global]);\n\n  if (needReady && !loaded) {\n    return null;\n  }\n\n  return children;\n};\n\nexport const useGlobalValue = createFunction(\"useGlobalValue\", (z) => {\n  return {\n    args: [z.string().describe(\"globalKey:需要从global获取的值\")],\n    returns: z.unknown().describe(\"获取到的global的key的值\")\n  };\n}, \"获取global里面的globalKey对应的值的hooks\")((globalKey) => {\n  const { global } = useContext();\n  return global[globalKey];\n});\n\nconst globalValuePropTypes = createProps(\"GlobalValue\", (z) => {\n  return [{\n    globalKey: z.string().describe(\"需要获取的global的key\"),\n    children: z.function().args(z.object({ value: z.unknown().describe(\"获取到的global的key的值\") }))\n  }, { children: true, globalKey: true }];\n}, \"获取global中globalKey的值\");\n\nexport const GlobalValue = (p) => {\n  const { globalKey, children } = globalValuePropTypes(p);\n  const value = useGlobalValue(globalKey);\n  return children({ value });\n};\n\nconst presetPropTypes = createProps(\"Preset\", (z) => {\n  return [{\n    children: z.function().args(z.unknown().describe(\"预设对象\")).describe(\"接收预设对象的方法\")\n  }, { children: true }];\n}, \"获取Preset的值\");\n\nexport const Preset = (p) => {\n  const { children } = presetPropTypes(p);\n  const preset = usePreset();\n  return children(preset);\n};\n\nexport default Global;\n"],"names":["createContext","initValue","arguments","length","undefined","context","createContext$1","Provider","Consumer","useContext","useContext$1","useGlobalContext","usePreset","contextValue","Object","assign","apis","preset","globalPropTypes","createProps","z","unknown","default","describe","children","Global","p","_globalPropTypes","props","_objectWithoutPropertiesLoose","_excluded","global","setGlobal","useState","setGlobalWithKey","useCallback","globalKey","value","React","_extends","globalSettingPropTypes","loader","function","returns","promise","needReady","boolean","GlobalSetting","loaded","setLoaded","globalRef","useRef","loaderRef","useEffect","current","then","target","nextGlobal","useGlobalValue","createFunction","args","string","globalValuePropTypes","object","GlobalValue","presetPropTypes","Preset"],"sourceRoot":""}